<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ëª¨ë°”ì¼ Code 128 ë°”ì½”ë“œ ìŠ¤ìºë„ˆ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: sans-serif;
            background: #f9f9f9;
            text-align: center;
        }
        h2 {
            margin-top: 1.5rem;
        }
        video {
            width: 95vw;
            max-width: 400px;
            max-height: 40vh;
            border: 2px solid #4caf50;
            border-radius: 10px;
            background: #000;
        }
        #result {
            font-size: 1.3rem;
            margin-top: 1.5rem;
            color: #2196f3;
            word-break: break-all;
        }
    </style>
</head>
<body>
    <h2>ğŸ“± ë°”ì½”ë“œ ìŠ¤ìº” (Code 128)</h2>
    <video id="video" muted autoplay playsinline></video>
    <div id="result">ë°”ì½”ë“œë¥¼ ì¹´ë©”ë¼ì— ë¹„ì¶°ì£¼ì„¸ìš”</div>

    <script type="module">
        import { BrowserMultiFormatReader, BarcodeFormat } from 'https://cdn.jsdelivr.net/npm/@zxing/browser@0.1.1/+esm';

        const codeReader = new BrowserMultiFormatReader();
        const videoElement = document.getElementById('video');
        const resultDiv = document.getElementById('result');

        codeReader.listVideoInputDevices().then(videoInputDevices => {
            // í›„ë©´ ì¹´ë©”ë¼ ìš°ì„  ì„ íƒ
            let backCamera = videoInputDevices.find(device => device.label.toLowerCase().includes('back'));
            let selectedDeviceId = backCamera ? backCamera.deviceId : videoInputDevices[0].deviceId;

            codeReader.decodeFromVideoDevice(selectedDeviceId, videoElement, (result, err) => {
                if (result) {
                    resultDiv.textContent = `âœ… ì¸ì‹ ê²°ê³¼: ${result.getText()}`;
                    codeReader.reset(); // í•œ ë²ˆë§Œ ì¸ì‹ í›„ ë©ˆì¶¤
                }
            }, { formats: [BarcodeFormat.CODE_128] });
        }).catch(err => {
            resultDiv.textContent = 'ì¹´ë©”ë¼ ì ‘ê·¼ ì‹¤íŒ¨: ' + err;
        });
    </script>
</body>
</html>
